# ๐ ุฏููู ุฅุนุงุฏุฉ ุงูุจูุงุก ุงูุดุงููุฉ ูููุธุงู

## ๐ ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅุฌุฑุงุก ุฅุนุงุฏุฉ ููููุฉ ูุงููุฉ ูููุธุงู ุดููุช:
- ุฅุนุงุฏุฉ ุชูุฒูุน ุงูุตูุงุญูุงุช ุจูู ุงููุฏูุฑ ุงูุนุงู ูุงููุดุฑู ุงูููู
- ุจูุงุก ูุธุงู ุฅุดุนุงุฑุงุช ููุฑูุฉ
- ุฑุจุท ุชูุนูู ุงูุญุณุงุจุงุช ุจุนูููุฉ ุงูุฏูุน
- ุฅุฑุณุงู ุฅููููุงุช ุงุญุชุฑุงููุฉ ุจุงุณุชุฎุฏุงู PHPMailer

---

## ๐ฏ ุงููุฑุญูุฉ 1: ุฅุตูุงุญ ุงูุชูุฌูู ูุงูุตูุงุญูุงุช โ

### ุงูุชุบููุฑุงุช ูู `Manager/login.php`
- โ **ุฌููุน ุงูุฃุฏูุงุฑ** (manager, technical, student, trainer) ูุชู ุชูุฌูููู ุฅูู `dashboard.php`
- โ ุชู ุฅุตูุงุญ ูุดููุฉ ุงูููุญุฉ ุงูููุณูุฑุฉ

### ุชูุฒูุน ุงูุตูุงุญูุงุช ุงูุฌุฏูุฏ ูู `Manager/dashboard.php`

#### ูููุฏูุฑ ุงูุนุงู (manager) ููุท:
- ๐ ููุญุฉ ุงูุชุญูู (ุงูุฅุญุตุงุฆูุงุช)
- ๐ ุงูุฎุฑูุฌูู ูุงูุดูุงุฏุงุช
- ๐ก๏ธ ุงูููุฆุฉ ุงูุฅุฏุงุฑูุฉ
- โ๏ธ ุงูุฅุนุฏุงุฏุงุช (SMTP, WhatsApp)

#### ูููุดุฑู ุงูููู (technical) ููุท:
- ๐ ุทูุจุงุช ุงูุชุณุฌูู
- ๐ฐ ุงูุดุคูู ุงููุงููุฉ (ุฑุจุท ุงูุฏูุน ุจุงูุชูุนูู)
- ๐ ุฅุฏุงุฑุฉ ุงูุฏุฑุฌุงุช
- ๐ข ุฅุฏุงุฑุฉ ุงูุฅุนูุงูุงุช

#### ูุดุชุฑู (manager + technical):
- ๐ฅ ุงููุชุฏุฑุจูู
- ๐จโ๐ซ ุงููุฏุฑุจูู
- ๐ ุงูุจุฑุงูุฌ ูุงูุฏูุฑุงุช
- ๐บ๏ธ ููููุฉ ุงูููุงุทู
- ๐ค ุงุณุชูุฑุงุฏ Excel

---

## ๐ ุงููุฑุญูุฉ 2: ูุธุงู ุงูุฅุดุนุงุฑุงุช โ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
```sql
-- ุฌุฏูู ุงูุฅุดุนุงุฑุงุช
CREATE TABLE notifications (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT NOT NULL,
  message TEXT NOT NULL,
  link VARCHAR(255),
  is_read TINYINT(1) DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

### APIs ุงูููุดุฃุฉ
1. **`Manager/api/get_notifications.php`**
   - ุฌูุจ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
   - ููุณุชุฏุนู ุชููุงุฆูุงู ูู 30 ุซุงููุฉ

2. **`Manager/api/mark_notification_read.php`**
   - ุชูููุฒ ุงูุฅุดุนุงุฑ ูููุฑูุก ุนูุฏ ุงูุถุบุท ุนููู

### ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- โ ุฒุฑ ุงูุฌุฑุณ ูู header
- โ ููุทุฉ ุญูุฑุงุก ุชุธูุฑ ุนูุฏ ูุฌูุฏ ุฅุดุนุงุฑุงุช
- โ ูุงุฆูุฉ ููุณุฏูุฉ ุชุนุฑุถ ุงูุฅุดุนุงุฑุงุช
- โ ุงูุถุบุท ุนูู ุฅุดุนุงุฑ ูููุฒู ูููุฑูุก ููุฐูุจ ููุฑุงุจุท

---

## ๐ณ ุงููุฑุญูุฉ 3: ูุธุงู ุงูุฏูุน ุงููุชุฑุงุจุท โ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
```sql
-- ุฅุถุงูุฉ ุนููุฏ ุญุงูุฉ ุงูุฏูุน
ALTER TABLE enrollments 
ADD COLUMN payment_status ENUM('pending', 'paid') DEFAULT 'pending';
```

### ุงูุชุฏูู ุงูุฌุฏูุฏ

#### 1. ุงูููุงููุฉ ุนูู ุงูุทูุจ (ูู `manage_enrollments.php`)
```
ุทูุจ ุฌุฏูุฏ โ ุงููุดุฑู ููุงูู โ ุฅุฑุณุงู ุฅูููู "ุงูููุงููุฉ ุงููุจุฏุฆูุฉ"
                          โ
          ุฅูุดุงุก ุณุฌู enrollments ุจุญุงูุฉ payment_status='pending'
                          โ
          ุฅูุดุงุก ุฅุดุนุงุฑ ูููุฏูุฑ: "ุจุงูุชุธุงุฑ ุชุฃููุฏ ุงูุฏูุน"
```

#### 2. ุชุฃููุฏ ุงูุฏูุน (ูู `manage_finance.php`)
```
ุงููุดุฑู ูุคูุฏ ุงูุฏูุน โ ุชุญุฏูุซ payment_status='paid'
                          โ
                    ุชูุนูู ุงูุญุณุงุจ (verified=1)
                          โ
              ุชูููุฏ ูููุฉ ูุฑูุฑ ูู ุฑูู ุงููุงุชู
                          โ
            ุฅุฑุณุงู ุฅูููู "ุชูุนูู ุงูุญุณุงุจ" ุจุงูุจูุงูุงุช
                          โ
          ุฅูุดุงุก ุฅุดุนุงุฑ ูููุฏูุฑ: "ุชู ุชุฃููุฏ ุงูุฏูุน"
```

---

## ๐ง ุงููุฑุญูุฉ 4: ูุธุงู ุงูุงุชุตุงูุงุช (PHPMailer) โ

### ุงูุชุซุจูุช
```bash
cd c:\xampp\htdocs\Ibdaa-Taiz
php composer.phar require phpmailer/phpmailer --ignore-platform-reqs
```

### API ุงูุงุชุตุงูุงุช (`send_communication.php`)
ูุฏุนู 3 ุฃููุงุน ูู ุงูุฑุณุงุฆู:

#### 1. Approval (ุงูููุงููุฉ ุงููุจุฏุฆูุฉ)
- ุนููุงู: โ ุชูุช ุงูููุงููุฉ ุนูู ุทูุจ ุงูุชุณุฌูู
- ุงููุญุชูู: ุงุณู ุงูุฏูุฑุฉ + ุงูุฎุทูุงุช ุงูุชุงููุฉ + ุฑุงุจุท ูุงุชุณุงุจ

#### 2. Rejection (ุงูุฑูุถ)
- ุนููุงู: โ ุฅุดุนุงุฑ ุจุดุฃู ุทูุจ ุงูุชุณุฌูู
- ุงููุญุชูู: ุณุจุจ ุงูุฑูุถ + ุฑุงุจุท ุงูุชูุงุตู

#### 3. Activation (ุงูุชูุนูู)
- ุนููุงู: ๐ ุชู ุชูุนูู ุญุณุงุจู
- ุงููุญุชูู: ุจูุงูุงุช ุงูุฏุฎูู (username + password) + ุฑุงุจุท ุชุณุฌูู ุงูุฏุฎูู

### ุฅุนุฏุงุฏุงุช SMTP
ูุชู ุญูุธูุง ูู ุฌุฏูู `settings`:
- `smtp_host` (ูุซุงู: smtp.gmail.com)
- `smtp_port` (ูุซุงู: 587)
- `smtp_user` (ุงูุจุฑูุฏ ุงูุฅููุชุฑููู)
- `smtp_pass` (ูููุฉ ูุฑูุฑ ุงูุชุทุจูู)
- `smtp_from_name` (ูุซุงู: ููุตุฉ ุฅุจุฏุงุน)
- `whatsapp_number` (ูุซุงู: 967700000000)

---

## โ๏ธ ุงููุฑุญูุฉ 5: ูุธุงู ุงูุฅุนุฏุงุฏุงุช โ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
```sql
CREATE TABLE settings (
  setting_key VARCHAR(50) PRIMARY KEY,
  setting_value TEXT
);
```

### API ุงูุฅุนุฏุงุฏุงุช (`manage_settings.php`)
- **GET**: ุฌูุจ ุฌููุน ุงูุฅุนุฏุงุฏุงุช
- **POST (action=update)**: ุชุญุฏูุซ ุงูุฅุนุฏุงุฏุงุช

### ุงููุงุฌูุฉ (ูู `renderSettings()`)
ูุฌุจ ุฅูุดุงุก ูููุฐุฌ ูุญุชูู ุนูู:
- ุงุณู ุงููููุน
- ุฅุนุฏุงุฏุงุช SMTP (Host, Port, User, Pass)
- ุฑูู ูุงุชุณุงุจ

---

## ๐ฑ ุงุณุชุฎุฏุงู ุงููุธุงู

### ูููุดุฑู ุงูููู:

#### 1. ุงุณุชูุจุงู ุทูุจ ุฌุฏูุฏ
- ุงูุฐูุงุจ ุฅูู "ุทูุจุงุช ุงูุชุณุฌูู"
- ุงูุถุบุท ุนูู "ููุงููุฉ" ุฃู "ุฑูุถ"
- ุนูุฏ ุงูุฑูุถ: ุฅุฏุฎุงู ุงูุณุจุจ ูู Modal
- ุงููุธุงู ูุฑุณู ุฅูููู ุชููุงุฆูุงู

#### 2. ุชุฃููุฏ ุงูุฏูุน
- ุงูุฐูุงุจ ุฅูู "ุงูุดุคูู ุงููุงููุฉ"
- ูุธูุฑ ุฌุฏูู ุจุงูุทูุงุจ ุงูุฐูู ุญุงูุชูู `payment_status='pending'`
- ุงูุถุบุท ุนูู "๐ฐ ุชุฃููุฏ ุงูุฏูุน"
- ุงููุธุงู ููุนูู ุงูุญุณุงุจ ููุฑุณู ุงูุจูุงูุงุช

### ูููุฏูุฑ ุงูุนุงู:

#### 1. ูุฑุงูุจุฉ ุงูุฅุดุนุงุฑุงุช
- ุฃููููุฉ ุงูุฌุฑุณ ูู ุงูุฃุนูู
- ูุธูุฑ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
- ุงูุถุบุท ุนูู ุฅุดุนุงุฑ ููุฐูุงุจ ููุตูุญุฉ ุงููุทููุจุฉ

#### 2. ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช
- ุงูุฐูุงุจ ุฅูู "ุงูุฅุนุฏุงุฏุงุช"
- ุฅุฏุฎุงู ุจูุงูุงุช SMTP ูุฑูู ูุงุชุณุงุจ
- ุญูุธ ุงูุฅุนุฏุงุฏุงุช

---

## ๐ง ูููุงุช SQL ุงููุทููุจุฉ

ูุฌุจ ุชูููุฐ ูุฐู ุงููููุงุช ุจุงูุชุฑุชูุจ:

1. **`database/notifications.sql`** - ุฌุฏูู ุงูุฅุดุนุงุฑุงุช
2. **`database/settings.sql`** - ุฌุฏูู ุงูุฅุนุฏุงุฏุงุช
3. **`database/update_enrollments_payment.sql`** - ุฅุถุงูุฉ ุนููุฏ payment_status

### ููููุฉ ุงูุชูููุฐ:
```bash
# ูู phpMyAdmin ุฃู MySQL command line
mysql -u root -p ibdaa_db < database/notifications.sql
mysql -u root -p ibdaa_db < database/settings.sql
mysql -u root -p ibdaa_db < database/update_enrollments_payment.sql
```

---

## ๐ ุงูููุงู ุงููุชุจููุฉ (ููุฅููุงู)

### 1. ุฅูุดุงุก renderSettings()
ููู: `Manager/dashboard.php`
- ูููุฐุฌ ุจุญููู ุงูุฅุนุฏุงุฏุงุช
- ุงุณุชุฏุนุงุก `api/manage_settings.php`

### 2. ุชุญุฏูุซ renderFinance()
- ุฌูุจ ุงูุจูุงูุงุช ูู `enrollments WHERE payment_status='pending'`
- ุฅุถุงูุฉ ุฒุฑ "ุชุฃููุฏ ุงูุฏูุน" ููู ุณุฌู
- ุงุณุชุฏุนุงุก `api/manage_finance.php` ูุน `action=confirm_payment`

### 3. ุชุญุฏูุซ renderRequests()
- ุฅุถุงูุฉ Modal ููุฑูุถ (rejection_reason)
- ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู `api/manage_enrollments.php`

### 4. ุฅูุดุงุก renderAnnouncements()
- CRUD ูุงูู ููุฅุนูุงูุงุช
- ูููุดุฑู ุงูููู ููุท

### 5. ุชุญููู platform/index.html ุฅูู .php
- ุฌูุจ ุงูุฅุนูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุนุฑุถูุง ููุฒูุงุฑ

### 6. ุชุญุฏูุซ get_dashboard_stats.php
- ุฅุถุงูุฉ "ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช" ูู payments
- ุฅุถุงูุฉ "ุงูุฏููู" ูู enrollments (pending)

---

## ๐จ ุฃููุงุฏ CSS ุฅุถุงููุฉ

ุฅุฐุง ูุฒู ุงูุฃูุฑุ ุฃุถู ูุฐู ุงูุฃููุงุท ูู `<style>`:

```css
/* ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช ุงูููุณุฏูุฉ */
#notificationDropdown {
    max-height: 400px;
    overflow-y: auto;
}

#notificationDropdown::-webkit-scrollbar {
    width: 6px;
}

#notificationDropdown::-webkit-scrollbar-thumb {
    background: #cbd5e0;
    border-radius: 3px;
}

/* ุชุฃุซูุฑ hover ุนูู ุงูุฅุดุนุงุฑุงุช */
#notificationList > div:hover {
    background-color: #f7fafc;
}
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงูุฅููููุงุช ูุง ุชูุฑุณู
1. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช SMTP ูู ุฌุฏูู `settings`
2. ุงุณุชุฎุฏู "ูููุฉ ูุฑูุฑ ุงูุชุทุจูู" ูู Gmail (ููุณ ูููุฉ ุงููุฑูุฑ ุงูุนุงุฏูุฉ)
3. ุชุญูู ูู `allow_url_fopen = On` ูู `php.ini`

### ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ
1. ุชุฃูุฏ ูู ุชูููุฐ `database/notifications.sql`
2. ุงูุชุญ console ุงููุชุตูุญ ูุงุจุญุซ ุนู ุฃุฎุทุงุก JavaScript
3. ุชุญูู ูู `fetchNotifications()` ูู `dashboard.php`

### payment_status ุบูุฑ ููุฌูุฏ
1. ูููุฐ `database/update_enrollments_payment.sql`
2. ุฃู ุฃุถู ุงูุนููุฏ ูุฏููุงู:
```sql
ALTER TABLE enrollments ADD COLUMN payment_status ENUM('pending','paid') DEFAULT 'pending';
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

- [x] ุฅุนุงุฏุฉ ููููุฉ ุงูุตูุงุญูุงุช
- [x] ูุธุงู ุงูุฅุดุนุงุฑุงุช (ุฌุฏุงูู + APIs + ูุงุฌูุฉ)
- [x] ุฑุจุท ุงูููุงููุฉ ุจุงูุฅูููู
- [x] ุฑุจุท ุงูุฏูุน ุจุงูุชูุนูู
- [x] PHPMailer ูุซุจุช ูุฌุงูุฒ
- [x] ุฌุฏูู settings ููุดุฃ
- [x] API ุงูุฅุนุฏุงุฏุงุช ุฌุงูุฒ
- [ ] renderSettings() (ูุญุชุงุฌ ุฅููุงู)
- [ ] renderFinance() ูุญุฏูุซ (ูุญุชุงุฌ ุฅููุงู)
- [ ] renderRequests() ูุน Modal ุงูุฑูุถ (ูุญุชุงุฌ ุฅููุงู)
- [ ] renderAnnouncements() (ูุญุชุงุฌ ุฅูุดุงุก)
- [ ] platform/index.php ูุน ุงูุฅุนูุงูุงุช (ูุญุชุงุฌ ุชุญููู)

---

## ๐ ุงูุชูุงุตู ูุงูุฏุนู

ุนูุฏ ููุงุฌูุฉ ุฃู ูุดููุฉ:
1. ุงูุชุญ console ุงููุชุตูุญ (`F12`)
2. ุชุญูู ูู Network Tab ูุฑุคูุฉ ุงุณุชุฌุงุจุฉ APIs
3. ุฑุงุฌุน ูููุงุช ุงูุฃุฎุทุงุก ูู XAMPP (logs)

**ูุฌุงุญ ุชูููุฐ ุงููุธุงู! ๐**
