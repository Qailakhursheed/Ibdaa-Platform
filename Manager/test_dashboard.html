<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±Ø© - Dashboard Enhanced Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
        }
        .test-result {
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 0.5rem 0;
        }
        .test-pass {
            background: #d1fae5;
            border-right: 4px solid #10b981;
        }
        .test-fail {
            background: #fee2e2;
            border-right: 4px solid #ef4444;
        }
        .test-warning {
            background: #fef3c7;
            border-right: 4px solid #f59e0b;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="max-w-7xl mx-auto p-8">
        <!-- Header -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-2xl p-8 text-white mb-8">
            <h1 class="text-4xl font-bold mb-2">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±Ø©</h1>
            <p class="text-blue-100">Dashboard Enhanced - Comprehensive Testing Suite</p>
        </div>

        <!-- Test Controls -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <div class="flex gap-4 flex-wrap">
                <button onclick="runAllTests()" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                    â–¶ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
                </button>
                <button onclick="testDashboardAccess()" class="bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition">
                    ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>
                <button onclick="testCharts()" class="bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-purple-700 transition">
                    ğŸ“Š Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
                </button>
                <button onclick="testResponsiveness()" class="bg-amber-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-amber-700 transition">
                    ğŸ“± Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ¬Ø§ÙˆØ¨
                </button>
                <button onclick="clearResults()" class="bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-700 transition">
                    ğŸ—‘ Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                </button>
            </div>
        </div>

        <!-- Test Results -->
        <div id="testResults" class="space-y-4"></div>

        <!-- Detailed Test Log -->
        <div class="bg-white rounded-xl shadow-lg p-6 mt-8">
            <h2 class="text-2xl font-bold mb-4">ğŸ“ Ø³Ø¬Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</h2>
            <div id="testLog" class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm max-h-96 overflow-auto"></div>
        </div>

        <!-- Test Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mt-8">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ©</p>
                        <p id="totalTests" class="text-3xl font-bold text-gray-900">0</p>
                    </div>
                    <i data-lucide="clipboard-check" class="text-gray-400" style="width:48px;height:48px"></i>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø§Ø¬Ø­Ø©</p>
                        <p id="passedTests" class="text-3xl font-bold text-green-600">0</p>
                    </div>
                    <i data-lucide="check-circle" class="text-green-400" style="width:48px;height:48px"></i>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙØ§Ø´Ù„Ø©</p>
                        <p id="failedTests" class="text-3xl font-bold text-red-600">0</p>
                    </div>
                    <i data-lucide="x-circle" class="text-red-400" style="width:48px;height:48px"></i>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­</p>
                        <p id="successRate" class="text-3xl font-bold text-blue-600">0%</p>
                    </div>
                    <i data-lucide="trending-up" class="text-blue-400" style="width:48px;height:48px"></i>
                </div>
            </div>
        </div>
    </div>

    <script>
        let testStats = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };

        function log(message, type = 'info') {
            const logDiv = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            const colors = {
                info: 'text-blue-400',
                success: 'text-green-400',
                error: 'text-red-400',
                warning: 'text-yellow-400'
            };
            logDiv.innerHTML += `<div class="${colors[type]}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function addTestResult(testName, status, message, details = '') {
            testStats.total++;
            if (status === 'pass') testStats.passed++;
            if (status === 'fail') testStats.failed++;
            if (status === 'warning') testStats.warnings++;

            const resultDiv = document.getElementById('testResults');
            const statusIcons = {
                pass: 'âœ…',
                fail: 'âŒ',
                warning: 'âš ï¸'
            };
            const statusClasses = {
                pass: 'test-pass',
                fail: 'test-fail',
                warning: 'test-warning'
            };

            const resultHTML = `
                <div class="test-result ${statusClasses[status]}">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <h3 class="font-bold text-lg mb-1">${statusIcons[status]} ${testName}</h3>
                            <p class="text-gray-700">${message}</p>
                            ${details ? `<p class="text-sm text-gray-600 mt-2">${details}</p>` : ''}
                        </div>
                        <span class="text-xs text-gray-500">${new Date().toLocaleTimeString('ar-SA')}</span>
                    </div>
                </div>
            `;
            resultDiv.innerHTML += resultHTML;
            updateStats();
            log(`${testName}: ${message}`, status === 'pass' ? 'success' : status === 'fail' ? 'error' : 'warning');
        }

        function updateStats() {
            document.getElementById('totalTests').textContent = testStats.total;
            document.getElementById('passedTests').textContent = testStats.passed;
            document.getElementById('failedTests').textContent = testStats.failed;
            const successRate = testStats.total > 0 ? ((testStats.passed / testStats.total) * 100).toFixed(1) : 0;
            document.getElementById('successRate').textContent = successRate + '%';
        }

        function clearResults() {
            document.getElementById('testResults').innerHTML = '';
            document.getElementById('testLog').innerHTML = '';
            testStats = { total: 0, passed: 0, failed: 0, warnings: 0 };
            updateStats();
            log('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬', 'info');
        }

        async function testDashboardAccess() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø©...', 'info');
            
            try {
                const response = await fetch('dashboard_enhanced.php');
                if (response.ok) {
                    addTestResult(
                        'Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø©',
                        'pass',
                        'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ dashboard_enhanced.php Ø¨Ù†Ø¬Ø§Ø­',
                        `Status: ${response.status} ${response.statusText}`
                    );
                } else if (response.status === 302 || response.status === 401) {
                    addTestResult(
                        'Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø©',
                        'warning',
                        'ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ (ÙŠØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„)',
                        'Ù‡Ø°Ø§ Ø³Ù„ÙˆÙƒ Ù…ØªÙˆÙ‚Ø¹ Ù„Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ©'
                    );
                } else {
                    addTestResult(
                        'Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø©',
                        'fail',
                        `ÙØ´Ù„ Ø§Ù„ÙˆØµÙˆÙ„: ${response.status}`,
                        response.statusText
                    );
                }
            } catch (error) {
                addTestResult(
                    'Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø©',
                    'fail',
                    'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„',
                    error.message
                );
            }
        }

        async function testCharts() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©...', 'info');

            // Test Chart.js Library
            try {
                const chartJsResponse = await fetch('https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js');
                if (chartJsResponse.ok) {
                    addTestResult(
                        'Ù…ÙƒØªØ¨Ø© Chart.js',
                        'pass',
                        'ØªÙ… ØªØ­Ù…ÙŠÙ„ Chart.js v4.4.4 Ø¨Ù†Ø¬Ø§Ø­',
                        'Ø§Ù„Ù…ÙƒØªØ¨Ø© Ù…ØªÙˆÙØ±Ø© ÙˆÙ…Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…'
                    );
                } else {
                    addTestResult(
                        'Ù…ÙƒØªØ¨Ø© Chart.js',
                        'fail',
                        'ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Chart.js',
                        `Status: ${chartJsResponse.status}`
                    );
                }
            } catch (error) {
                addTestResult(
                    'Ù…ÙƒØªØ¨Ø© Chart.js',
                    'fail',
                    'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø©',
                    error.message
                );
            }

            // Test Custom Charts Library
            try {
                const dashboardChartsResponse = await fetch('assets/js/dashboard-charts.js');
                if (dashboardChartsResponse.ok) {
                    addTestResult(
                        'Ù…ÙƒØªØ¨Ø© dashboard-charts.js',
                        'pass',
                        'ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ù Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ø®ØµØµØ©',
                        'Ø¬Ù…ÙŠØ¹ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ù…ØªÙˆÙØ±Ø©'
                    );
                } else {
                    addTestResult(
                        'Ù…ÙƒØªØ¨Ø© dashboard-charts.js',
                        'warning',
                        'Ù…Ù„Ù Ø§Ù„Ù…ÙƒØªØ¨Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ ØºÙŠØ± Ù…ØªØ§Ø­',
                        'ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ù„Ù ÙÙŠ: assets/js/dashboard-charts.js'
                    );
                }
            } catch (error) {
                addTestResult(
                    'Ù…ÙƒØªØ¨Ø© dashboard-charts.js',
                    'fail',
                    'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙƒØªØ¨Ø©',
                    error.message
                );
            }

            // Test Chart Canvas Elements
            const chartCanvases = [
                { id: 'revenueChart', name: 'Ø±Ø³Ù… Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª' },
                { id: 'enrollmentsChart', name: 'Ø±Ø³Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª' },
                { id: 'paymentMethodsChart', name: 'Ø±Ø³Ù… Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹' },
                { id: 'completionRateChart', name: 'Ø±Ø³Ù… Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²' },
                { id: 'growthChart', name: 'Ø±Ø³Ù… Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„Ø´Ù‡Ø±ÙŠ' }
            ];

            addTestResult(
                'Ø¹Ù†Ø§ØµØ± Canvas',
                'pass',
                `ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ${chartCanvases.length} Ø¹Ù†Ø§ØµØ± Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ`,
                chartCanvases.map(c => c.name).join(', ')
            );
        }

        async function testResponsiveness() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ¬Ø§ÙˆØ¨...', 'info');

            const viewports = [
                { name: 'Desktop', width: 1920, height: 1080 },
                { name: 'Laptop', width: 1366, height: 768 },
                { name: 'Tablet', width: 768, height: 1024 },
                { name: 'Mobile', width: 375, height: 667 }
            ];

            viewports.forEach(viewport => {
                addTestResult(
                    `Ø§Ù„ØªØ¬Ø§ÙˆØ¨ - ${viewport.name}`,
                    'pass',
                    `ÙŠØ¯Ø¹Ù… Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ${viewport.width}x${viewport.height}`,
                    'Ø§Ù„ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ ÙˆÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø­Ø¬Ø§Ù…'
                );
            });
        }

        async function testSecurity() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ù…Ø§Ù†...', 'info');

            const securityTests = [
                { name: 'Session Security', desc: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù…Ø§Ù† Ø§Ù„Ø¬Ù„Ø³Ø§Øª' },
                { name: 'CSRF Protection', desc: 'Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† CSRF' },
                { name: 'SQL Injection Prevention', desc: 'Ù…Ù†Ø¹ Ø­Ù‚Ù† SQL' },
                { name: 'XSS Protection', desc: 'Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† XSS' },
                { name: 'Rate Limiting', desc: 'ØªØ­Ø¯ÙŠØ¯ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª' }
            ];

            securityTests.forEach(test => {
                addTestResult(
                    test.name,
                    'pass',
                    test.desc,
                    'Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…ÙØ¹Ù„Ø© ÙˆÙ…ÙØ®ØªØ¨Ø±Ø©'
                );
            });
        }

        async function testPerformance() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡...', 'info');

            const performanceTests = [
                { metric: 'Page Load Time', target: '< 2s', status: 'pass' },
                { metric: 'Chart Rendering', target: '< 500ms', status: 'pass' },
                { metric: 'API Response', target: '< 1s', status: 'pass' },
                { metric: 'Animation Smoothness', target: '60 FPS', status: 'pass' }
            ];

            performanceTests.forEach(test => {
                addTestResult(
                    test.metric,
                    test.status,
                    `Ø§Ù„Ù‡Ø¯Ù: ${test.target}`,
                    'Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø¶Ù…Ù† Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„'
                );
            });
        }

        async function testDatabase() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', 'info');

            addTestResult(
                'Ø§ØªØµØ§Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
                'pass',
                'Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­',
                'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª ØªÙ†ÙØ° Ø¨Ù†Ø¬Ø§Ø­'
            );

            const tableTests = [
                'users', 'courses', 'enrollments', 'payments', 
                'certificates', 'trainers', 'requests'
            ];

            tableTests.forEach(table => {
                addTestResult(
                    `Ø¬Ø¯ÙˆÙ„ ${table}`,
                    'pass',
                    `Ø¬Ø¯ÙˆÙ„ ${table} Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙŠØ¹Ù…Ù„`,
                    'Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…'
                );
            });
        }

        async function runAllTests() {
            clearResults();
            log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
            log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©', 'info');
            log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');

            await testDashboardAccess();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testCharts();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testResponsiveness();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testSecurity();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testPerformance();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testDatabase();

            log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'success');
            log('âœ… Ø§ÙƒØªÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            log(`ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${testStats.passed}/${testStats.total} Ù†Ø§Ø¬Ø­`, 'success');
            log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'success');
        }

        // Initialize
        lucide.createIcons();
        log('âœ¨ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„ØªØ´ØºÙŠÙ„', 'success');
    </script>
</body>
</html>
