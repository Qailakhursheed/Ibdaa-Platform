<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” RBAC Sidebar Counter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
    </style>
</head>
<body class="p-8">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-2xl shadow-2xl p-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">
                ğŸ” RBAC Sidebar Counter
            </h1>
            <p class="text-gray-600 text-center mb-8">
                Ø£Ø¯Ø§Ø© ÙØ­Øµ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
            </p>

            <!-- Test Buttons -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <button onclick="testRole('manager')" 
                        class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-xl transition">
                    Ø§Ù„Ù…Ø¯ÙŠØ±
                </button>
                <button onclick="testRole('technical')" 
                        class="bg-amber-600 hover:bg-amber-700 text-white font-bold py-4 px-6 rounded-xl transition">
                    Ø§Ù„ÙÙ†ÙŠ
                </button>
                <button onclick="testRole('trainer')" 
                        class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-xl transition">
                    Ø§Ù„Ù…Ø¯Ø±Ø¨
                </button>
                <button onclick="testRole('student')" 
                        class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-xl transition">
                    Ø§Ù„Ø·Ø§Ù„Ø¨
                </button>
            </div>

            <!-- Results -->
            <div id="results" class="bg-gray-50 rounded-xl p-6 min-h-[300px]">
                <div class="text-center text-gray-400 text-lg">
                    Ø§Ø®ØªØ± Ø¯ÙˆØ±Ø§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sidebar link definitions from dashboard.php
        const sidebarLinks = [
            { page: 'dashboard', roles: 'manager,technical,trainer', label: 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…' },
            { page: 'trainees', roles: 'manager,technical', label: 'Ø§Ù„Ù…ØªØ¯Ø±Ø¨ÙˆÙ†' },
            { page: 'trainers', roles: 'manager,technical', label: 'Ø§Ù„Ù…Ø¯Ø±Ø¨ÙˆÙ†' },
            { page: 'courses', roles: 'manager,technical,trainer', label: 'Ø§Ù„Ø¯ÙˆØ±Ø§Øª' },
            { page: 'finance', roles: 'manager,technical', label: 'Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù…Ø§Ù„ÙŠØ©' },
            { page: 'requests', roles: 'manager,technical', label: 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª' },
            { page: 'announcements', roles: 'manager,technical,trainer', label: 'Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª' },
            { page: 'notifications', roles: 'manager,technical,trainer,student', label: 'Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª' },
            { page: 'grades', roles: 'manager,technical,trainer', label: 'Ø§Ù„Ø¯Ø±Ø¬Ø§Øª ÙˆØ§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª' },
            { page: 'messages', roles: 'manager,technical,trainer', label: 'Ø§Ù„Ø±Ø³Ø§Ø¦Ù„' },
            { page: 'attendanceReports', roles: 'manager', label: 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ±' },
            { page: 'analytics', roles: 'manager', label: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©' },
            { page: 'locations', roles: 'manager,technical', label: 'Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹' },
            { page: 'import', roles: 'manager,technical', label: 'Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø°ÙƒÙŠ' },
            { page: 'idCards', roles: 'technical', label: 'Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©' },
            { page: 'graduates', roles: 'manager', label: 'Ø§Ù„Ø®Ø±ÙŠØ¬ÙˆÙ†' },
            { page: 'aiImages', roles: 'manager,technical', label: 'AI ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±' },
            { page: 'settings', roles: 'manager', label: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' }
        ];

        const expectedCounts = {
            'manager': 16,
            'technical': 12,
            'trainer': 7,
            'student': 1
        };

        const roleLabels = {
            'manager': 'Ø§Ù„Ù…Ø¯ÙŠØ±',
            'technical': 'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„ÙÙ†ÙŠ',
            'trainer': 'Ø§Ù„Ù…Ø¯Ø±Ø¨',
            'student': 'Ø§Ù„Ø·Ø§Ù„Ø¨'
        };

        function testRole(role) {
            const visibleLinks = sidebarLinks.filter(link => {
                const allowedRoles = link.roles.split(',').map(r => r.trim());
                return allowedRoles.includes(role);
            });

            const hiddenLinks = sidebarLinks.filter(link => {
                const allowedRoles = link.roles.split(',').map(r => r.trim());
                return !allowedRoles.includes(role);
            });

            const actualCount = visibleLinks.length;
            const expectedCount = expectedCounts[role];
            const isCorrect = actualCount === expectedCount;

            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">
                            Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø±: ${roleLabels[role]}
                        </h2>
                        <div class="text-4xl font-bold ${isCorrect ? 'text-green-600' : 'text-red-600'}">
                            ${actualCount} / ${expectedCount}
                        </div>
                    </div>
                    
                    <div class="p-4 rounded-lg ${isCorrect ? 'bg-green-100 border-2 border-green-500' : 'bg-red-100 border-2 border-red-500'}">
                        <div class="text-lg font-bold ${isCorrect ? 'text-green-800' : 'text-red-800'}">
                            ${isCorrect ? 'âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© ØµØ­ÙŠØ­Ø©!' : 'âŒ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø®Ø§Ø·Ø¦Ø©!'}
                        </div>
                        <div class="text-sm ${isCorrect ? 'text-green-700' : 'text-red-700'} mt-1">
                            ${isCorrect 
                                ? 'Ø¹Ø¯Ø¯ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ØªÙ…Ø§Ù…Ø§Ù‹' 
                                : `ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ${expectedCount} Ù„ÙƒÙ† Ø§Ù„ÙØ¹Ù„ÙŠ ${actualCount}`
                            }
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Visible Links -->
                    <div>
                        <h3 class="text-lg font-bold text-green-700 mb-3 flex items-center gap-2">
                            <span class="text-2xl">âœ…</span>
                            <span>Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© (${visibleLinks.length})</span>
                        </h3>
                        <div class="space-y-2">
                            ${visibleLinks.map((link, index) => `
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center gap-3">
                                    <span class="flex-shrink-0 w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold">
                                        ${index + 1}
                                    </span>
                                    <div class="flex-1">
                                        <div class="font-semibold text-gray-800">${link.label}</div>
                                        <div class="text-xs text-gray-500">${link.page}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Hidden Links -->
                    <div>
                        <h3 class="text-lg font-bold text-red-700 mb-3 flex items-center gap-2">
                            <span class="text-2xl">âŒ</span>
                            <span>Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø®ÙÙŠØ© (${hiddenLinks.length})</span>
                        </h3>
                        ${hiddenLinks.length > 0 ? `
                            <div class="space-y-2">
                                ${hiddenLinks.map(link => `
                                    <div class="bg-red-50 border border-red-200 rounded-lg p-3 flex items-center gap-3 opacity-60">
                                        <span class="flex-shrink-0 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-sm">
                                            ğŸš«
                                        </span>
                                        <div class="flex-1">
                                            <div class="font-semibold text-gray-800">${link.label}</div>
                                            <div class="text-xs text-gray-500">${link.page}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div class="text-center text-gray-400 py-8">
                                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ù…Ø®ÙÙŠØ©<br>
                                (Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ± Ù„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ© ÙƒØ§Ù…Ù„Ø©)
                            </div>
                        `}
                    </div>
                </div>

                <!-- Exclusive Features -->
                <div class="mt-6 p-4 bg-purple-50 border-2 border-purple-200 rounded-lg">
                    <h3 class="text-lg font-bold text-purple-800 mb-2">
                        ğŸ¯ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø­ØµØ±ÙŠØ© Ù„Ù€ ${roleLabels[role]}:
                    </h3>
                    <div class="text-gray-700">
                        ${getExclusiveFeatures(role, visibleLinks)}
                    </div>
                </div>
            `;
        }

        function getExclusiveFeatures(role, visibleLinks) {
            const exclusiveMap = {
                'manager': ['ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ±', 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©', 'Ø§Ù„Ø®Ø±ÙŠØ¬ÙˆÙ†', 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª'],
                'technical': ['Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© ğŸ´'],
                'trainer': ['Ø¥Ø¯Ø§Ø±Ø© Ø¯ÙˆØ±Ø§ØªÙ‡ Ø§Ù„Ø®Ø§ØµØ©', 'Ø¥Ø¯Ø®Ø§Ù„ Ø¯Ø±Ø¬Ø§Øª Ø·Ù„Ø§Ø¨Ù‡'],
                'student': ['ÙˆØ§Ø¬Ù‡Ø© Ù…Ù†ÙØµÙ„Ø© ØªÙ…Ø§Ù…Ø§Ù‹ - Ù„Ø§ sidebar Ø¥Ø¯Ø§Ø±ÙŠ']
            };

            const features = exclusiveMap[role] || [];
            
            if (role === 'manager') {
                const exclusiveLinks = visibleLinks.filter(link => 
                    ['attendanceReports', 'analytics', 'graduates', 'settings'].includes(link.page)
                );
                return exclusiveLinks.map(link => 
                    `<div class="flex items-center gap-2 py-1">
                        <span class="text-purple-600">â­</span>
                        <span class="font-semibold">${link.label}</span>
                    </div>`
                ).join('');
            } else if (role === 'technical') {
                const idCardsLink = visibleLinks.find(link => link.page === 'idCards');
                return `<div class="flex items-center gap-2 py-1">
                    <span class="text-purple-600">â­</span>
                    <span class="font-semibold">${idCardsLink ? idCardsLink.label : 'Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©'} ğŸ´ (Ø­ØµØ±ÙŠ Ù„Ù„ÙÙ†ÙŠ ÙÙ‚Ø·)</span>
                </div>`;
            } else {
                return features.map(f => 
                    `<div class="flex items-center gap-2 py-1">
                        <span class="text-purple-600">â­</span>
                        <span class="font-semibold">${f}</span>
                    </div>`
                ).join('');
            }
        }

        // Auto-test manager on load
        window.onload = () => {
            testRole('manager');
        };
    </script>
</body>
</html>
