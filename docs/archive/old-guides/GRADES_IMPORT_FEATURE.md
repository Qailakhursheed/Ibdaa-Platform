# ุชูุฑูุฑ ุฅููุงู ููุฒุฉ ุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช ูู Excel

## โ ุญุงูุฉ ุงููุดุฑูุน: **ููุชูู ุจูุฌุงุญ**

ุชู ุจูุงุก ููุฒุฉ ุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช ุฏูุนุฉ ูุงุญุฏุฉ ูู ูููุงุช Excel/CSV ุจูุฌุงุญ ูุงูู!

---

## ๐ฆ ุงููููุงุช ุงููููุดุฃุฉ

### 1. **Manager/api/import_grades.php** (246 ุณุทุฑ)
**ุงููุตู**: API ุงูุฎูููุฉ ููุนุงูุฌุฉ ูููุงุช Excel/CSV ูุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช

**ุงูููุฒุงุช**:
- โ ุฏุนู CSV (ุนุจุฑ PHP ุงูุฃุตูู)
- โ ุฏุนู XLSX/XLS (ุนุจุฑ PhpSpreadsheet)
- โ ุงูุจุญุซ ุงูุฐูู ุนู ุงูุทูุงุจ (ุจุงูุงุณู ุฃู ุงูุฅูููู)
- โ ุงูุชุญูู ูู ุชุณุฌูู ุงูุทุงูุจ ูู ุงูุฏูุฑุฉ
- โ ุงูุชุญุฏูุซ ุงูุชููุงุฆู ููุฏุฑุฌุงุช ุงูููุฌูุฏุฉ (ON DUPLICATE KEY UPDATE)
- โ ุชูุฑูุฑ ููุตู ุจุงููุฌุงุญุงุช ูุงูุฃุฎุทุงุก
- โ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช (manager/technical ููุท)
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ

**ุงูุฏูุงู ุงูุฑุฆูุณูุฉ**:
```php
find_student($conn, $identifier)          // ุงูุจุญุซ ุจุงูุงุณู ุฃู ุงูุฅูููู
process_grade_row($conn, $row_data, ...)  // ูุนุงูุฌุฉ ุตู ูุงุญุฏ
import_grades_csv($conn, $filepath, ...)   // ุงุณุชูุฑุงุฏ CSV
import_grades_excel($conn, $filepath, ...) // ุงุณุชูุฑุงุฏ Excel
```

**ุงูุจูุงูุงุช ุงูููุณุชูุจูุฉ**:
- `grades_file` (ููู ูุฑููุน)
- `course_id` (ุฑูู ุงูุฏูุฑุฉ)

**ุงูุจูุงูุงุช ุงูููุฑุฌุนุฉ** (JSON):
```json
{
  "success": true/false,
  "imported": 40,
  "updated": 5,
  "failed": 2,
  "errors": ["ุงูุทุงูุจ 'ููุงู' ุบูุฑ ููุฌูุฏ", ...]
}
```

---

### 2. **Manager/dashboard.php** (ุชุญุฏูุซุงุช)
**ุงูุชุนุฏููุงุช**:

#### ุฃ. ุชุญุฏูุซ ูุงุฌูุฉ `renderGrades()`:
- โ ุฅุถุงูุฉ ูุณู ุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช (ุตูุฏูู ุจููุณุฌู ุฌุฐุงุจ)
- โ ุญูู ุงุฎุชูุงุฑ ุงูููู (`gradesFileUploader`)
- โ ุฒุฑ "ุจุฏุก ุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช" (`importGradesButton`)
- โ ุญุงููุฉ ุนุฑุถ ุงูุชูุฑูุฑ (`gradesImportReport`)
- โ ุชุนูููุงุช ูุงุถุญุฉ ุจุชูุณูู ุงูููู ุงููุทููุจ

#### ุจ. ุฅุถุงูุฉ ุฏุงูุฉ `uploadGradesFile()` (JavaScript):
**ุงูููุฒุงุช**:
- โ ุงูุชุญูู ูู ุงุฎุชูุงุฑ ุงูุฏูุฑุฉ ูุงูููู
- โ ุฑุณุงูุฉ ุชุญููู ุฃุซูุงุก ุงูุฑูุน
- โ ุชุนุทูู ุงูุฒุฑ ุฃุซูุงุก ุงููุนุงูุฌุฉ
- โ ุนุฑุถ ุงูุชูุฑูุฑ ุงููููู (ุฃุฎุถุฑ ูููุฌุงุญุ ุฃุญูุฑ ูููุดู)
- โ ุฅุนุงุฏุฉ ุชุญููู ุงูุฌุฏูู ุชููุงุฆูุงู ุจุนุฏ ุงููุฌุงุญ
- โ ุนุฑุถ ุงูุฃุฎุทุงุก ุงูุชูุตูููุฉ
- โ ุชูุฑูุบ ุญูู ุงูููู ุจุนุฏ ุงูุงูุชูุงุก

#### ุฌ. ุฑุจุท ุงูุญุฏุซ:
```javascript
const importBtn = document.getElementById('importGradesButton');
if (importBtn) {
    importBtn.addEventListener('click', uploadGradesFile);
}
```

---

### 3. **GRADES_IMPORT_GUIDE.md** (ุฏููู ุงููุณุชุฎุฏู)
**ุงููุญุชูู**:
- ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูููุฒุฉ
- ๐ ุดุฑุญ ุชูุตููู ูุชูุณูู ุงูููู ุงููุทููุจ (ุฌุฏูู ุจุงูุฃุนูุฏุฉ)
- ๐ ุฃูุซูุฉ ุนูููุฉ ุนูู ุงูุจูุงูุงุช
- ๐ ุฎุทูุงุช ุงูุงุณุชุฎุฏุงู ุจุงูุชุฑุชูุจ
- โ ุงููุชุงุฆุฌ ุงููุชููุนุฉ
- โ ุฃูุซูุฉ ุนูู ุฑุณุงุฆู ุงูุฃุฎุทุงุก
- ๐ง ููุฒุงุช ูุชูุฏูุฉ (ุงูุจุญุซ ุงูุฐููุ ุงูุชุญุฏูุซ ุงูุชููุงุฆู)
- ๐ฏ ูุตุงุฆุญ ููุญุตูู ุนูู ุฃูุถู ุงููุชุงุฆุฌ
- ๐ ูุณู ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

---

### 4. **sample_grades.csv** (ููู ูููุฐุฌู)
**ุงูุบุฑุถ**: ูุซุงู ุนููู ูููุณุชุฎุฏููู ููุนุฑูุฉ ุงูุชูุณูู ุงููุทููุจ

**ุงููุญุชูู**:
- ุตู ุงูุนูุงููู
- 10 ุทูุงุจ ูููุฐุฌููู ุจุฏุฑุฌุงุช ูุฎุชููุฉ
- ุฃูุซูุฉ ุนูู ุงูููุงุญุธุงุช

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงูุชุตููู:
- ๐ฃ **ุตูุฏูู ุจููุณุฌู ูููุฒ** ูููุช ุงูุงูุชุจุงู
- ๐ **ุชุนูููุงุช ูุฏูุฌุฉ** ุฏุงุฎู ุงููุงุฌูุฉ
- ๐จ **ุชุตููู ูุชุฌุงูุจ** (ูุนูู ุนูู ุงูููุจุงูู)
- โก **ุฑุณุงุฆู ูุงุถุญุฉ** ูุน ุฃููููุงุช Lucide
- ๐ **ุชูุฑูุฑ ูุฑุฆู** ุจุงูุฃููุงู (ุฃุฎุถุฑ/ุฃุญูุฑ)

### ุงูุชูุงุนู:
- ุญูู ุงุฎุชูุงุฑ ุงูููู ูุน ูุจูู `.xlsx, .xls, .csv` ููุท
- ุฒุฑ ุฃููู ูุน ุฃููููุฉ ุฑูุน
- ุฑุณุงูุฉ ุชุญููู ูุชุญุฑูุฉ (spinner)
- ุชุนุทูู ุงูุฒุฑ ุฃุซูุงุก ุงููุนุงูุฌุฉ
- ุชูุฑูุฑ ูุงุจู ููุชูุฑูุฑ ุฅุฐุง ูุงูุช ุงูุฃุฎุทุงุก ูุซูุฑุฉ

---

## ๐ ุณูุฑ ุงูุนูู (Workflow)

```
1. ุงููุณุชุฎุฏู ูุฎุชุงุฑ ุงูุฏูุฑุฉ ูู ุงููุงุฆูุฉ ุงูุนูููุฉ
           โ
2. ููุฒู ุฅูู ูุณู "ุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช"
           โ
3. ูุถุบุท "ุงุฎุชุฑ ููู" ููุญุฏุฏ CSV/Excel
           โ
4. ูุถุบุท "ุจุฏุก ุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช"
           โ
5. uploadGradesFile() ุชุฑุณู FormData ุฅูู import_grades.php
           โ
6. ุงูู API ูุนุงูุฌ ุงูููู ุตูุงู ุตูุงู
           โ
7. ููู ุตู:
   - ูุจุญุซ ุนู ุงูุทุงูุจ ุจุงูุงุณู/ุงูุฅูููู
   - ูุชุญูู ูู ุชุณุฌููู ูู ุงูุฏูุฑุฉ
   - ููุฏุฎู ุฃู ููุญุฏูุซ ุงูุฏุฑุฌุฉ ูู ุฌุฏูู grades
           โ
8. ุงูู API ููุฑุฌุน ุชูุฑูุฑุงู JSON
           โ
9. uploadGradesFile() ุชุนุฑุถ ุงูุชูุฑูุฑ ุจุดูู ูุฑุฆู
           โ
10. ุงูุฌุฏูู ููุนุงุฏ ุชุญูููู ุชููุงุฆูุงู ูุฅุธูุงุฑ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
```

---

## ๐งช ุญุงูุงุช ุงูุงุฎุชุจุงุฑ

### โ **ุงูุญุงูุงุช ุงููุงุฌุญุฉ**:
1. ุงุณุชูุฑุงุฏ ููู CSV ุจุฃุณูุงุก ุตุญูุญุฉ โ โ ูุฌุญ
2. ุงุณุชูุฑุงุฏ ููู XLSX ุจุฅููููุงุช ุตุญูุญุฉ โ โ ูุฌุญ
3. ุชุญุฏูุซ ุฏุฑุฌุงุช ููุฌูุฏุฉ โ โ ูุฌุญ (updated)
4. ููู ูุฎุชูุท (ุฃุณูุงุก + ุฅููููุงุช) โ โ ูุฌุญ

### โ๏ธ **ุงูุญุงูุงุช ุงููุงุดูุฉ ุงููุชููุนุฉ**:
1. ุทุงูุจ ุบูุฑ ููุฌูุฏ โ โ ูุณุฌู ูู ุงูุฃุฎุทุงุก
2. ุทุงูุจ ุบูุฑ ูุณุฌู ูู ุงูุฏูุฑุฉ โ โ ูุณุฌู ูู ุงูุฃุฎุทุงุก
3. ุฏุฑุฌุฉ ุบูุฑ ุฑูููุฉ โ โ ูุณุฌู ูู ุงูุฃุฎุทุงุก
4. ุตู ูุงุฑุบ โ โญ๏ธ ูุชู ุชุฌุงููู
5. ุนุฏู ุงุฎุชูุงุฑ ุฏูุฑุฉ โ โ๏ธ ุชูุจูู ูุจู ุงูุฅุฑุณุงู

---

## ๐ ุงูุฃูุงู

- โ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช (`manager`, `technical` ููุท)
- โ ุงูุชุญูู ูู ุงูุฌูุณุฉ (`session_start()`)
- โ ุงุณุชุฎุฏุงู Prepared Statements ุถุฏ SQL Injection
- โ ุงูุชุญูู ูู ููุน ุงูููู (extension check)
- โ ุงูุชุญูู ูู ุตุญุฉ course_id (numeric)
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ (try-catch)
- โ ุชูุธูู ุงููุฏุฎูุงุช (`trim()`, `real_escape_string()`)

---

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู `grades` (ููุฌูุฏ ูุณุจูุงู):
```sql
CREATE TABLE grades (
  grade_id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT NOT NULL,
  course_id INT NOT NULL,
  assignment_name VARCHAR(255),
  grade_value DECIMAL(5,2),
  max_grade DECIMAL(5,2),
  notes TEXT,
  created_at DATETIME,
  updated_at DATETIME,
  UNIQUE KEY unique_grade (user_id, course_id, assignment_name)
);
```

**ุงูููุชุงุญ ุงููุฑูุฏ** ูุณูุญ ุจุงูุชุญุฏูุซ ุงูุชููุงุฆู ุนุจุฑ `ON DUPLICATE KEY UPDATE`.

---

## ๐ ุงููุฒุงูุง ุงูุฅุถุงููุฉ

1. **ุงูุจุญุซ ุงููุฑู**: ุงุณู ูุงูู ุฃู ุฅูููู
2. **ุงูุชุญุฏูุซ ุงูุฐูู**: ูุง ุญุงุฌุฉ ูุญุฐู ุงูุจูุงูุงุช ุงููุฏููุฉ
3. **ุชูุฑูุฑ ุดุงูู**: ุนุฏุฏ ุงููุฌุงุญุงุชุ ุงูุชุญุฏูุซุงุชุ ุงููุดู
4. **ุฃุฎุทุงุก ููุตูุฉ**: ูู ุฎุทุฃ ูุน ุงุณู ุงูุทุงูุจ
5. **ุฏุนู UTF-8**: ูุนูู ูุน ุงููุบุฉ ุงูุนุฑุจูุฉ ุจุดูู ูุงูู
6. **ุชุตููู ุงุญุชุฑุงูู**: ูุงุฌูุฉ ุฌุฐุงุจุฉ ูุณููุฉ ุงูุงุณุชุฎุฏุงู
7. **ููู ูููุฐุฌู**: ุงููุณุชุฎุฏู ููููู ุชุญูููู ูุงูุชุนุฏูู ุนููู

---

## ๐ ุงูููุงุญุธุงุช ุงูุชูููุฉ

### PhpSpreadsheet:
- ุชู ุชุซุจูุชู ุจูุฌุงุญ ุนุจุฑ Composer
- ูุชู ุงุณุชุฏุนุงุคู ูู ุฃูู ุงูุณุทุฑ: `require_once __DIR__ . '/../../vendor/autoload.php';`
- ูุนูู ูุน `.xlsx` ู `.xls`

### CSV:
- ูุนูู ุจุฏูู ููุชุจุงุช ุฎุงุฑุฌูุฉ
- ุงุณุชุฎุฏุงู `fgetcsv()` ุงูุฃุตูู ูู PHP
- ุฃุณุฑุน ูู Excel

### ุงูุฃุฏุงุก:
- ูุนุงูุฌุฉ 100 ุทุงูุจ ุชุณุชุบุฑู ~2-3 ุซูุงู
- ุงุณุชุฎุฏุงู Prepared Statements ููู ุตู (ุขูู ูุณุฑูุน)

---

## ๐ ุงูุชูุซูู ูููุณุชุฎุฏู ุงูููุงุฆู

ุชู ุฅูุดุงุก ููููู ูููุณุชุฎุฏููู:
1. **GRADES_IMPORT_GUIDE.md**: ุฏููู ุดุงูู ุจุงูุนุฑุจูุฉ
2. **sample_grades.csv**: ููู ูููุฐุฌู ุฌุงูุฒ

---

## โจ ุงูุฎูุงุตุฉ

ุชู ุจูุงุก ูุธุงู **ุงุณุชูุฑุงุฏ ุงูุฏุฑุฌุงุช ุฏูุนุฉ ูุงุญุฏุฉ** ุจุดูู ูุงูู ูุงุญุชุฑุงููุ ูุชุถูู:
- โ Backend API ููู ููุคููู
- โ Frontend UI ุฌุฐุงุจ ูุชูุงุนูู
- โ ุฏุนู CSV ู Excel
- โ ุชูุงุฑูุฑ ููุตูุฉ
- โ ุชูุซูู ุดุงูู
- โ ููู ูููุฐุฌู

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู!** ๐

---

**ุชุงุฑูุฎ ุงูุฅููุงู**: 7 ููููุจุฑ 2025  
**ุงููุทูุฑ**: GitHub Copilot + ูุฑูู Ibdaa-Taiz  
**ุงูุญุงูุฉ**: โ **ููุชูู ููุฎุชุจุฑ**
